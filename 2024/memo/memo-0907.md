## monorepoとは
## good/bad points
## 本質について...(

### overheadが一度で済むのがメリット, 
### 大き過ぎると扱いにくくなるのがデメリット)

### 望ましい状態

#### 凝集度が高い。

一つの個体の中に、その個体を定義するに必要な情報だけが含まれている状態。

e.g. 車クラスの機能実現するもの「だけ」が含まれている状態。

repoの例の場合は、何か手を加えたい際にそのrepoの中だけで完結すること。
<=> 逆にそうでない場合は結合性が高いことになりうる

内外のboudaryをどこに決めるのか...?

#### 結合度が高い 

e.g. Aの変更をした際にBへの影響を考慮しないといけない状況

原理的には良くないはず...
モチベーションとしては、特定の変更をする際に考えることを減らしたい。(脳死で変更ができるように...)


どういう需要件だったらmonorepoを選ぶべきか?


何がprojectなのかはサービス次第..
チームとかも関係してくるのがpj

=> ProjectがIdeaだとしたらrepoは言葉
言葉からideaを逆算するのはあまり自明ではない。
自分が考えているideaをどういうことばで表現するか、手間が一番減るか...を考えるべきこと。

monorepo, polyrepoの議論だけをやるんだとしたら、
綺麗、可愛いの違いの議論をしているのと同じ気がする..
意味があるのは何かを見た時に綺麗、可愛いの言葉の議論というよりかは
repoとproject

経験則として主張するなら、大半の小規模のものはmonorepoで十分
=> どこかの段階でrepoを分ける必要がある(polyrepo化)が分ける際の判断材料は..?

前提として同じrepoに入ってるコードは複数人の管理下にある & その複数人はソースコードに対して同じ権限を保持している。(コードに対する権限/責任は複数人が平等に持っている)

1. コードが大きすぎてパフォーマンス悪化(大半のケースでは考慮しなくて良)
2. 現在のgithubのrepoで実現ができないようなケース(polyrepoではできて、monorepoではできないこと) => issue, pr, 閲覧権

(2. 権限保持者が多過ぎる場合(e.g. コードに対する変化が激し過ぎるケース、決定権が複数人に分散しているようなケース))

=> repoに対する変化は誰か決定者が存在する。その決定processに時間がかかり過ぎる(効率が悪過ぎる)場合は、repo(権限)を分ける 同じrepoの中で権限を分けることがgit上はできない。詰まるところ、権限を分ける => repoを分ける。

もちろんproject次第ではあるけど、その中でも大事な要素は
規模 = コード？人数??ビジネス???


## 話を戻す。

基本的に関係あるものは同じrepoで管理したい。
=> 極論同じrepoに置いちゃえば良くない...?

そうしない理由は...
1. performanceの問題
2. 権限の分離ができない / repoのmainのownerが必要(神様を分離したい...ってなったらそのrepoを分ける必要がある)

会社単位でprojectをmonorepo化しない理由。
=> 全部のrepoが会社の所有物ではあるけど、その概念を維持したまま、管理権を譲ることはできる

会社 => organization
その下 => project = repository



# Monorepoの本質と選択基準

## Monorepoとは
単一のリポジトリで複数のプロジェクトやコンポーネントを管理する開発アプローチ。

## メリットとデメリット

### メリット
- オーバーヘッドが一度で済む
- コード共有と再利用が容易
- 大規模なリファクタリングが簡単
- 依存関係の管理が簡素化

### デメリット
- リポジトリが大きくなりすぎると扱いにくくなる
- パフォーマンスの問題が発生する可能性
- アクセス制御が複雑になる

## 本質的な考慮点

### 凝集度と結合度
- **高凝集度**: 一つのリポジトリ内で必要な情報が完結している状態
- **低結合度**: 変更の影響範囲が限定的である状態

### 望ましい状態
- 高凝集度と低結合度のバランスを取ること
- 変更時の考慮事項を最小限に抑えること

## Monorepo採用の判断基準

1. プロジェクトの規模と複雑さ
2. チーム構造と協業のパターン
3. コードの共有度と再利用性
4. 権限管理の必要性

## リポジトリ分割の判断基準

1. パフォーマンスの著しい低下
2. 現在のGitHubの機能で実現できない要件の発生
3. 権限保持者が多すぎる場合
4. 決定プロセスの効率低下

## 実践的なアプローチ

- 基本的に関連するものは同じリポジトリで管理
- 会社単位ではなく、プロジェクト単位でリポジトリを考える
- 権限の分離が必要な場合はリポジトリを分割

## 結論
Monorepoの採用は、プロジェクトの特性や組織の構造に大きく依存する。
小規模なプロジェクトではMonorepoで十分な場合が多いが、
規模の拡大や権限の複雑化に応じて、適切なタイミングでリポジトリの分割を検討する必要がある。

Citations:
[1] https://livecycle.io/blogs/monorepos/
[2] https://lembergsolutions.com/blog/why-you-should-use-monorepo-and-why-you-shouldnt
[3] https://www.happycoders.eu/software-craftsmanship/monorepo-pros-and-cons/
[4] https://graphite.dev/guides/monorepo-pros-and-cons
[5] https://circleci.com/blog/monorepo-dev-practices/
[6] https://github.com/joelparkerhenderson/monorepo-vs-polyrepo/blob/main/README.md
[7] https://www.linkedin.com/pulse/pros-cons-monorepo-right-your-team-steven-francis
[8] https://fossa.com/blog/pros-cons-using-monorepos/


凝集度の高い1この個体より
結合度の高い2この個体を持った方が良いと判断した際。